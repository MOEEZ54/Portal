<div class="signup-wrapper glass">

  <h2 class="form-title">
    <span>SKY MEMBER</span> DETAILS FORM
  </h2>

  <form #signupForm="ngForm" (ngSubmit)="submitSignup(signupForm)" novalidate>

    <!-- PROFILE (TOP RIGHT) -->
    <div class="profile-card" aria-label="Profile picture">
      <label class="avatar" [class.has-image]="!!profilePreviewUrl">
        <input
          type="file"
          accept="image/*"
          (change)="handleFileInput($event,'profilePicture')"
          hidden
        />

        <img
          [src]="profilePreviewUrl || 'assets/user-circles-set_78370-4704.avif'"
          alt="Profile preview"
          class="avatar__img"
        />

        <div *ngIf="!profilePreviewUrl" class="avatar__placeholder">
          <div class="avatar__icon">ðŸ‘¤</div>
          <div class="avatar__hint">Upload photo</div>
        </div>

        <div class="avatar__overlay">
          <span class="avatar__overlayText">
            {{ profilePreviewUrl ? 'Change' : 'Upload' }}
          </span>
        </div>
      </label>

      <div class="profile-meta">
        <div class="profile-title">Profile Photo</div>
        <div class="profile-subtitle">JPG/PNG â€¢ Max 5MB</div>

        <small class="error" *ngIf="signupForm.submitted && !profilePictureFile">
          Profile Picture is required
        </small>
      </div>
    </div>

    <!-- PROJECT -->
    <div class="form-row one">
      <div class="form-group">
        <label>Project *</label>
        <select [(ngModel)]="signupData.project" name="project" required #project="ngModel">
          <option value="" disabled>Select Project</option>
          <option value="Sky View">Sky View</option>
          <option value="Sky Prime">Sky Prime</option>
          <option value="Sky Hills">Sky Hills</option>
          <option value="Sky 18 One">Sky 18 One</option>
          <option value="Address 17">Address 17</option>
          <option value="Alam One">Alam One</option>
          <option value="FT2">FT2</option>
        </select>
        <small class="error" *ngIf="showError(project, signupForm)">Project is required</small>
      </div>
    </div>

    <!-- BASIC INFO -->
    <div class="form-row">
      <div class="form-group">
        <label>Registration Number *</label>
        <input type="text" placeholder="e.g. REG-1023"
               [(ngModel)]="signupData.registrationNumber"
               name="registrationNumber" required #registrationNumber="ngModel">
        <small class="error" *ngIf="showError(registrationNumber, signupForm)">
          Registration Number is required
        </small>
      </div>

      <div class="form-group">
        <label>First Name *</label>
        <input type="text" placeholder="e.g. Ali"
               [(ngModel)]="signupData.firstName"
               name="firstName" required #firstName="ngModel">
        <small class="error" *ngIf="showError(firstName, signupForm)">First Name is required</small>
      </div>

      <div class="form-group">
        <label>Last Name *</label>
        <input type="text" placeholder="e.g. Khan"
               [(ngModel)]="signupData.lastName"
               name="lastName" required #lastName="ngModel">
        <small class="error" *ngIf="showError(lastName, signupForm)">Last Name is required</small>
      </div>
    </div>

    <!-- USERNAME + PASSWORD -->
    <div class="form-row">
      <div class="form-group">
        <label>Username *</label>
        <input type="text" placeholder="e.g. faizan123"
               [(ngModel)]="signupData.username"
               name="username"
               required minlength="4"
               #username="ngModel">

        <small class="error" *ngIf="showError(username, signupForm) && username.errors?.['required']">
          Username is required
        </small>
        <small class="error" *ngIf="showError(username, signupForm) && username.errors?.['minlength']">
          Username must be at least 4 characters
        </small>
      </div>

      <div class="form-group">
        <label>Password *</label>
        <input type="password" placeholder="Min 6 characters"
               [(ngModel)]="signupData.password"
               name="password"
               required minlength="6"
               #password="ngModel">

        <small class="error" *ngIf="showError(password, signupForm) && password.errors?.['required']">
          Password is required
        </small>
        <small class="error" *ngIf="showError(password, signupForm) && password.errors?.['minlength']">
          Password must be at least 6 characters
        </small>
      </div>
    </div>

    <!-- EMAIL -->
    <div class="form-row">
      <div class="form-group">
        <label>Email *</label>
        <input type="email" inputmode="email" placeholder="e.g. name@gmail.com"
               [(ngModel)]="signupData.email"
               name="email" required email #email="ngModel">

        <small class="error" *ngIf="showError(email, signupForm) && email.errors?.['required']">
          Email is required
        </small>
        <small class="error" *ngIf="showError(email, signupForm) && email.errors?.['email']">
          Please enter a valid email
        </small>
      </div>
    </div>

    <!-- PERSONAL -->
    <div class="form-row">
      <div class="form-group">
        <label>Phone No *</label>
        <input type="text" inputmode="tel"
               placeholder="03XXXXXXXXX or +923XXXXXXXXX"
               [(ngModel)]="signupData.phone"
               name="phone"
               required
               pattern="^(\+92|0)3\d{9}$"
               maxlength="13"
               #phone="ngModel">

        <small class="error" *ngIf="showError(phone, signupForm) && phone.errors?.['required']">
          Phone No is required
        </small>
        <small class="error" *ngIf="showError(phone, signupForm) && phone.errors?.['pattern']">
          Enter valid mobile: 03XXXXXXXXX or +923XXXXXXXXX
        </small>
      </div>
      


      <div class="form-group">
        <label>Date of Birth *</label>
        <input type="date"
               [(ngModel)]="signupData.dateOfBirth"
               name="dateOfBirth" required #dateOfBirth="ngModel">
        <small class="error" *ngIf="showError(dateOfBirth, signupForm)">Date of Birth is required</small>
      </div>

      <div class="form-group">
        <label>Mother Name *</label>
        <input type="text" placeholder="e.g. Ayesha"
               [(ngModel)]="signupData.motherName"
               name="motherName" required #motherName="ngModel">
        <small class="error" *ngIf="showError(motherName, signupForm)">Mother Name is required</small>
      </div>

      <div class="form-group">
        <label>Nationality *</label>
        <select [(ngModel)]="signupData.nationality" name="nationality" required #nationality="ngModel">
          <option value="" disabled>Select Nationality</option>
          <option>Pakistan</option>
          <option>Other</option>
        </select>
        <small class="error" *ngIf="showError(nationality, signupForm)">Nationality is required</small>
      </div>
    </div>

    <!-- CNIC -->
    <div class="form-row">
      <div class="form-group">
        <label>City *</label>
        <input type="text" placeholder="e.g. Lahore"
               [(ngModel)]="signupData.city"
               name="city" required #city="ngModel">
        <small class="error" *ngIf="showError(city, signupForm)">City is required</small>
      </div>

      <div class="form-group">
        <label>CNIC / NICOP *</label>
        <input
          type="text"
          inputmode="numeric"
          placeholder="Enter 13-digit CNIC"
          [(ngModel)]="signupData.cnic"
          name="cnic"
          required
          pattern="^\d{13}$"
          maxlength="13"
          (input)="onCnicInput()"
          #cnic="ngModel"
        />

        <small class="error" *ngIf="showError(cnic, signupForm) && cnic.errors?.['required']">
          CNIC is required
        </small>

        <small class="error" *ngIf="showError(cnic, signupForm) && cnic.errors?.['pattern']">
          CNIC must be 13 digits (without dashes)
        </small>
      </div>

      <div class="form-group">
        <label>CNIC Expiry Date *</label>
        <input type="date"
               [(ngModel)]="signupData.cnicExpiry"
               name="cnicExpiry" required #cnicExpiry="ngModel">
        <small class="error" *ngIf="showError(cnicExpiry, signupForm)">CNIC Expiry Date is required</small>
      </div>

      <div class="form-group">
        <label>Passport Number (Optional)</label>
        <input type="text" placeholder="e.g. AB1234567"
               [(ngModel)]="signupData.passportNumber"
               name="passportNumber">
      </div>
    </div>

    <!-- CONTACT -->
    <div class="form-row">
      <div class="form-group">
        <label>Passport Expiry Date (Optional)</label>
        <input type="date"
               [(ngModel)]="signupData.passportExpiry"
               name="passportExpiry">
      </div>

      <div class="form-group">
        <label>Primary WhatsApp No *</label>
        <input type="text" inputmode="tel"
               placeholder="03XXXXXXXXX or +923XXXXXXXXX"
               [(ngModel)]="signupData.primaryWhatsApp"
               name="primaryWhatsApp"
               required
               pattern="^(\+92|0)3\d{9}$"
               maxlength="13"
               #primaryWhatsApp="ngModel">

        <small class="error" *ngIf="showError(primaryWhatsApp, signupForm) && primaryWhatsApp.errors?.['required']">
          Primary WhatsApp No is required
        </small>
        <small class="error" *ngIf="showError(primaryWhatsApp, signupForm) && primaryWhatsApp.errors?.['pattern']">
          Enter valid WhatsApp: 03XXXXXXXXX or +923XXXXXXXXX
        </small>
      </div>

      <div class="form-group">
        <label>Alternate Mobile Number *</label>
        <input type="text" inputmode="tel"
               placeholder="03XXXXXXXXX or +923XXXXXXXXX"
               [(ngModel)]="signupData.alternateMobile"
               name="alternateMobile"
               required
               pattern="^(\+92|0)3\d{9}$"
               maxlength="13"
               #alternateMobile="ngModel">

        <small class="error" *ngIf="showError(alternateMobile, signupForm) && alternateMobile.errors?.['required']">
          Alternate Mobile Number is required
        </small>
        <small class="error" *ngIf="showError(alternateMobile, signupForm) && alternateMobile.errors?.['pattern']">
          Enter valid mobile: 03XXXXXXXXX or +923XXXXXXXXX
        </small>
      </div>
    </div>

    <!-- FILE UPLOADS -->
    <div class="form-row">
      <div class="form-group">
        <label>Upload CNIC Front *</label>
        <input type="file" (change)="handleFileInput($event,'cnicFront')">
        <small class="error" *ngIf="signupForm.submitted && !cnicFrontFile">
          CNIC Front is required
        </small>
      </div>

      <div class="form-group">
        <label>Upload CNIC Back *</label>
        <input type="file" (change)="handleFileInput($event,'cnicBack')">
        <small class="error" *ngIf="signupForm.submitted && !cnicBackFile">
          CNIC Back is required
        </small>
      </div>

      <div class="form-group">
        <label>Upload Allotment Letter (Optional)</label>
        <input type="file" (change)="handleFileInput($event,'allotmentLetter')">
      </div>
    </div>

    <!-- ADDRESS -->
    <div class="form-row two">
      <div class="form-group full">
        <label>Mailing & Delivery Address *</label>
        <textarea placeholder="House No, Street, Area, City"
                  [(ngModel)]="signupData.mailingAddress"
                  name="mailingAddress" required #mailingAddress="ngModel"></textarea>
        <small class="error" *ngIf="showError(mailingAddress, signupForm)">Mailing Address is required</small>
      </div>

      <div class="form-group full">
        <label>Permanent Address *</label>
        <textarea placeholder="House No, Street, Area, City"
                  [(ngModel)]="signupData.permanentAddress"
                  name="permanentAddress" required #permanentAddress="ngModel"></textarea>
        <small class="error" *ngIf="showError(permanentAddress, signupForm)">Permanent Address is required</small>
      </div>
    </div>

    <!-- CONFIRM -->
    <div class="terms">
      <input type="checkbox" [(ngModel)]="signupData.agreeTerms" name="agreeTerms" required #agreeTerms="ngModel">
      <span>I confirm the above information is correct</span>
    </div>
    <small class="error" *ngIf="showError(agreeTerms, signupForm)">
      Please confirm the above information
    </small>

    <button class="submit-btn" type="submit" [disabled]="!otpVerified">
  SUBMIT
</button>

    <p class="login-link">
      Already Registered?
      <a routerLink="/login">LOGIN</a>
    </p>

  </form>
</div>
